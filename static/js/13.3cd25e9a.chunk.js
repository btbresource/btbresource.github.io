webpackJsonp([13],{735:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),i=n.n(c),o=n(8),s=n(43),u=(n.n(s),n(109)),d=n(32),h=(n.n(d),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}()),p=function(e){function t(e){a(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dropdownOpen:!1,page:1,channelName:"\u9009\u62e9\u6536\u6b3e\u6e20\u9053",list:[],channel:-1,exchange:null,action:!1},n.filterOptions=["\u652f\u4ed8\u5b9d\u8d26\u53f7","\u5fae\u4fe1\u8d26\u53f7","\u94f6\u884c\u5361\u8d26\u53f7"],n.fee="1",n.deadline="5",n}return r(t,e),h(t,[{key:"componentDidMount",value:function(){var e=Object(d.loadLocalAccount)();e&&e.secret&&(this.secret=e.secret,this.account=e)}},{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"loadAll",value:function(){var e=this,t=Object(d.sign)(this.account.secret,this.account.pk),n={page:this.state.page,pk:this.account.pk,rsId:this.account.aid,token:t};Object(s.doExchange)(n,"0","5",0,function(t,n){t&&n&&n.ok&&e.setState({list:n.list})})}},{key:"filterExchange",value:function(e){var t=this,n=Object(d.sign)(this.account.secret,this.account.pk),a={pk:this.account.pk,rsId:this.account.aid,token:n};e||(e=this.state.amount),Object(s.doExchange)(a,e,"3",this.state.channel,function(e,n){e&&n&&n.ok&&t.setState({list:n.list})})}},{key:"updateExchangeStatus",value:function(){var e=Object(d.sign)(this.account.secret,this.account.pk),t={pk:this.account.pk,rsId:this.account.rsId,token:e,id:this.state.exchange.eid,status:2,tid:1234};Object(s.doExchange)(t,"0","4","0",function(e,t){e&&t&&t.ok?console.log(t):console.log("err")})}},{key:"doTransfer",value:function(){var e=this,t=this.account.pk,n={action:"transaction",type:"transfer",amount:""+this.state.exchange.amount,fee:this.fee,dealine:this.deadline,pk:t,recipientPk:this.state.exchange.pk,recipientId:this.state.exchange.id};Object(s.doBShopTransaction)(this.secret,n,function(t,n){t&&n.ok?(e.setState({dialogMsg:"success(\u6210\u529f),\u7b49\u5f85\u77ff\u5de5\u9a8c\u8bc1",tranferOk:!0}),e.updateExchangeStatus()):e.setState({dialogMsg:"err(\u5931\u8d25)"})}.bind(this))}},{key:"upateFilterValue",value:function(e){if(e&&e.target){var t=e.target.value;if(this.setState({amount:t}),t.length>2){var n=t.indexOf(".");if(n>0){t.substr(n+1).length>0&&this.filterExchange(t)}}}}},{key:"prePage",value:function(){this.state.page--,this.loadAll()}},{key:"nextPage",value:function(){this.state.page++,this.loadAll()}},{key:"setFilter",value:function(e){this.setState({channel:e,channelName:this.filterOptions[e]})}},{key:"renderFilterOptions",value:function(){var e=this;return this.filterOptions.map(function(t,n){return i.a.createElement(o.o,{onClick:function(t){e.setFilter(n)}},t)})}},{key:"toggleActionDialog",value:function(){this.setState({action:!this.state.action,dialogMsg:"",tranferOk:!1})}},{key:"renderActionDialog",value:function(){return this.state.exchange?i.a.createElement(o.C,{isOpen:this.state.action,toggle:this.toggleActionDialog.bind(this),className:"modal-info "+this.props.className},i.a.createElement(o.F,{toggle:this.toggleActionDialog.bind(this)},"Action(\u64cd\u4f5c)"),i.a.createElement(o.D,null,i.a.createElement("div",null,"\u7533\u8bf7\u8d26\u53f7\uff1a",i.a.createElement(u.a,{rsId:this.state.exchange.id})),i.a.createElement(o.s,null,i.a.createElement("div",{className:"controls"},i.a.createElement(o.u,{className:"input-prepend"},i.a.createElement(o.v,{addonType:"prepend"},i.a.createElement(o.w,null,"Account PK(\u8d26\u6237\u516c\u94a5):")),i.a.createElement(o.t,{id:"appendedPrependedInput",size:"16",type:"text",value:this.state.exchange.pk})))),i.a.createElement(o.s,null,i.a.createElement("div",{className:"controls"},i.a.createElement(o.u,{className:"input-prepend"},i.a.createElement(o.v,{addonType:"prepend"},i.a.createElement(o.w,null,"Amount (\u8f6c\u8d26\u91d1\u989d):")),i.a.createElement(o.t,{id:"appendedPrependedInput",size:"16",type:"text",value:this.state.exchange.amount})),i.a.createElement(o.v,{addonType:"append"},i.a.createElement(o.w,null,"BTB")))),i.a.createElement(o.s,null,i.a.createElement("div",{className:"controls"},i.a.createElement(o.u,{className:"input-prepend"},i.a.createElement(o.v,{addonType:"prepend"},i.a.createElement(o.w,null,"Fee(\u77ff\u5de5\u624b\u7eed\u8d39):")),i.a.createElement(o.t,{id:"appendedPrependedInput",size:"16",type:"text",onChange:this.updateFee.bind(this),placeholder:"miner Fee \u533a\u5757\u94fe\u77ff\u5de5\u8d39\uff0c\u6700\u5c111\u4e2a"}),i.a.createElement(o.v,{addonType:"append"},i.a.createElement(o.w,null,"BTB"))))),i.a.createElement(o.s,null,i.a.createElement("div",{className:"controls"},i.a.createElement(o.u,{className:"input-prepend"},i.a.createElement(o.v,{addonType:"prepend"},i.a.createElement(o.w,null,"Deadline(\u6709\u6548\u671f):")),i.a.createElement(o.t,{id:"appendedPrependedInput",size:"16",onChange:this.updateDeadline.bind(this),type:"text",placeholder:"\u4ea4\u6613\u6709\u6548\u671f\uff0c\u9ed8\u8ba45\u5206\u949f"}),i.a.createElement(o.v,{addonType:"append"},i.a.createElement(o.w,null,"minutes(\u5206\u949f)"))))),this.renderdialogMsg()),i.a.createElement(o.E,null,i.a.createElement(o.e,{color:"danger",onClick:this.toggleActionDialog.bind(this)},"\u53d6\u6d88"),this.renderPayBtn())):null}},{key:"renderPayBtn",value:function(){return this.state.tranferOk?null:i.a.createElement(o.e,{color:"danger",onClick:this.doTransfer.bind(this)},"\u53d1\u5e01")}},{key:"renderdialogMsg",value:function(){return this.state.dialogMsg?i.a.createElement(o.x,null,this.state.dialogMsg):null}},{key:"updateFee",value:function(e){if(e&&e.target){var t=e.target.value;t&&t.length>0&&(this.fee=t)}}},{key:"updateDeadline",value:function(e){if(e&&e.target){var t=e.target.value;this.deadline=t}}},{key:"renderExchangelist",value:function(){var e=this,t=this.state.list;return t?t.map(function(t){var n=new Date;n.setTime(t.time);var a=n.toLocaleString();n.setTime(t.update);var l=n.toLocaleString();return i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement(u.a,{rsId:t.id})),i.a.createElement("td",null,t.amount," BTB"),i.a.createElement("td",null,t.random," \u5143"),i.a.createElement("td",null,t.channel),i.a.createElement("td",null,t.ip),i.a.createElement("td",null,a),i.a.createElement("td",null,l),i.a.createElement("td",null,Object(s.getExchangeStatus)(t.status)),i.a.createElement("td",null,t.note),i.a.createElement("td",null,i.a.createElement(o.e,{size:"sm",onClick:function(n){e.setState({exchange:t}),e.toggleActionDialog()}.bind(e)},"\u64cd\u4f5c")))}):null}},{key:"render",value:function(){var e=this;return i.a.createElement(o.g,null,i.a.createElement(o.h,null,i.a.createElement(o.e,{color:"primary",onClick:function(t){return e.loadAll()}},i.a.createElement("i",{className:"fa fa-search"}),"\u663e\u793a\u5168\u90e8"),i.a.createElement(o.u,null,i.a.createElement(o.f,{isOpen:this.state.dropdownOpen,toggle:function(){e.toggle()}},i.a.createElement(o.q,{caret:!0},this.state.channelName),i.a.createElement(o.p,null,this.renderFilterOptions())),i.a.createElement(o.t,{placeholder:"\u8f93\u5165\u5df2\u6536\u6b3e\u91d1\u989d\uff0c\u7cbe\u786e\u5230\u5c0f\u6570\u70b9\u4e24\u4f4d\u641c\u7d22",onChange:this.upateFilterValue.bind(this)}),i.a.createElement(o.e,{color:"primary",onClick:function(t){return e.filterExchange()}},i.a.createElement("i",{className:"fa fa-search"}),"\xa0")),i.a.createElement(o.T,{hover:!0,bordered:!0,striped:!0,responsive:!0,size:"sm"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"ID"),i.a.createElement("th",null,"Amount(\u91d1\u989d)"),i.a.createElement("th",null,"\u968f\u673a\u91d1\u989d(\u91d1\u989d)"),i.a.createElement("th",null,"Channel(\u6e20\u9053)"),i.a.createElement("th",null,"Ip\u5730\u5740"),i.a.createElement("th",null,"Time(\u7533\u8bf7\u65f6\u95f4)"),i.a.createElement("th",null,"Update(\u66f4\u65b0\u65f6\u95f4)"),i.a.createElement("th",null,"Status(\u6700\u65b0\u72b6\u6001)"),i.a.createElement("th",null,"Note(\u5907\u6ce8)"),i.a.createElement("th",null,"Action(\u64cd\u4f5c)"))),i.a.createElement("tbody",null,this.renderExchangelist(),this.renderActionDialog())),i.a.createElement("nav",null,i.a.createElement(o.J,null,i.a.createElement(o.K,null,i.a.createElement(o.L,{previous:!0,tag:"button",onClick:function(t){e.prePage()}},"Prev(\u4e0a\u4e00\u9875)")),i.a.createElement(o.K,{active:!0},i.a.createElement(o.L,{tag:"button"},this.state.page)),i.a.createElement(o.K,null,i.a.createElement(o.L,{next:!0,tag:"button",onClick:function(t){e.nextPage()}},"Next(\u4e0b\u4e00\u9875)")))),i.a.createElement(o.a,{color:"danger"},i.a.createElement("small",null,"\u8d26\u6237\u91d1\u989d\u5927\u4e8e10000\u7684\u8d26\u6237\u624d\u6709\u6743\u9650\u67e5\u770b\u7cfb\u7edf\u5145\u503c\u5217\u8868."))))}}]),t}(c.Component);t.default=p}});
//# sourceMappingURL=13.3cd25e9a.chunk.js.map